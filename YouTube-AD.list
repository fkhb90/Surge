# AND,((PROTOCOL,UDP), (DEST-PORT,443)),REJECT-NO-DROP
# YouTube Ad-Block
DOMAIN-SUFFIX,googleadservices.com,REJECT
DOMAIN-SUFFIX,google-analytics.com,REJECT
DOMAIN-SUFFIX,googletagservices.com,REJECT
DOMAIN-SUFFIX,doubleclick.net,REJECT
DOMAIN-SUFFIX,googlesyndication.com,REJECT
DOMAIN-SUFFIX,adservice.google.com,REJECT
DOMAIN-SUFFIX,pagead2.googlesyndication.com,REJECT
DOMAIN-SUFFIX,partnerad.l.google.com,REJECT
DOMAIN-SUFFIX,ad.doubleclick.net,REJECT
DOMAIN-SUFFIX,securepubads.g.doubleclick.net,REJECT
DOMAIN-SUFFIX,tpc.googlesyndication.com,REJECT
DOMAIN-SUFFIX,pubads.g.doubleclick.net,REJECT
DOMAIN-SUFFIX,imasdk.googleapis.com,REJECT
DOMAIN-SUFFIX,ad.l.doubleclick.net,REJECT
DOMAIN-SUFFIX,admob.com,REJECT
DOMAIN-SUFFIX,ads.youtube.com,REJECT
DOMAIN-SUFFIX,advertising.com,REJECT
DOMAIN-SUFFIX,video-ad-stats.googlesyndication.com,REJECT
URL-REGEX,^https?\:\/\/[\w-]+\.googlevideo\.com\/(?!(dclk_video_ads|videoplayback\?)).+&oad
# URL-REGEX,^https?\://[\s\S]*\.googlevideo\.com/.*&(oad|ctier)
URL-REGEX,https?\:\/\/.+.googlevideo\.com\/ptracking\?pltype=adhost
URL-REGEX,https?\:\/\/[\w-]+\.googlevideo\.com\/.+&oad-TINYGIF
URL-REGEX,https?\:\/\/.*\.googlevideo\.com\/generate_204
URL-REGEX,https?\:\/\/.*\.googlevideo\.com\/generate_204?.*
URL-REGEX,https?\:\/\/.*\.googlevideo\.com\/generate_204\.*
URL-REGEX,https?\:\/\/.+\.googlevideo\.com\/videogoodput
URL-REGEX,^https?\:\/\/(www|s)\.youtube\.com\/api\/stats\/ads
URL-REGEX,^https?\:\/\/(www|s)\.youtube\.com\/(pagead|ptracking)
URL-REGEX,^https?\:\/\/s\.youtube\.com\/api\/stats\/qoe\?adcontext ctier=[A-Z]
URL-REGEX,^https?\:\/\/\w+\.youtube\.com\/(pagead|ptracking)
URL-REGEX,https?\:\/\/.+.youtube\.com\/api\/stats\/ads
URL-REGEX,https?\:\/\/.+.youtube\.com\/get_midroll_
URL-REGEX,https?\:\/\/.+.youtube\.com\/pagead\/
URL-REGEX,https?\:\/\/.*\.youtube\.com\/ptracking.*
URL-REGEX,https?\:\/\/.+.youtube\.com\/ptracking\?
URL-REGEX,https?\:\/\/.+.youtube\.com\/_get_ads
URL-REGEX,https?\:\/\/.+.youtube\.com\/log_event
URL-REGEX,https?\:\/\/.*\.youtube-nocookie\.com\/youtubei\/.*\/log_event.*
URL-REGEX,https?\:\/\/.*\.youtube\.com\/youtubei\/.*\/log_event\.*
URL-REGEX,https?\:\/\/.*\.youtube\.com\/api\/stats\/qoe\?adformat
URL-REGEX,https?\:\/\/.*\.youtube\.com\/api\/stats\/atr.*
URL-REGEX,https?\:\/\/.*\.youtube\.com\/generate_204
URL-REGEX,https?\:\/\/.*\.youtube\.com\/generate_204?.*
URL-REGEX,https?\:\/\/.*\.youtube\.com\/generate_204\.*
URL-REGEX,https?\:\/\/.+\.youtube\.com\/csi_204
URL-REGEX,https?\:\/\/.+\.youtube\.com\/error_204
URL-REGEX,https?\:\/\/.+\.youtube\.com\/get_midroll
URL-REGEX,https?\:\/\/.*\.youtube\.com\/api\/lounge\/pairing\/get_screen_availability\?.*
URL-REGEX,https?\:\/\/.*\.youtube\.com\/api\/lounge\/pairing\/get_lounge_token_batch\?
# URL-REGEX,https?\:\/\/.*\.youtube\.com\/s\/player\/.*\/fetch-polyfill\.vflset\/fetch-polyfill\.js
URL-REGEX,https?\:\/\/youtubei\.googleapis\.com\/youtubei\/.*\/att\/get\.*
URL-REGEX,https?\:\/\/youtubei\.googleapis\.com\/.+ad_break
URL-REGEX,https?\:\/\/youtubei\.googleapis\.com\/youtubei\/.*\/log_event\/.*
URL-REGEX,^https?\:\/\/youtubei\.googleapis\.com\/youtubei\/v\d\/player\/ad_break
URL-REGEX,^https?\:\/\/youtubei\.googleapis\.com\/youtubei\/.*\/[a-zA-Z0-9_]+(?:\/[a-zA-Z0-9_]+)*\?.*$
URL-REGEX,https?\:\/\/.+\.googleapis\.com\/adsmeasurement
URL-REGEX,https?\:\/\/.+\.googleapis\.com\/youtubei\/.*\/notification_registration
URL-REGEX,https?\:\/\/.+\.googleapis\.com\/youtubei\/.*\/guide
URL-REGEX,https?\:\/\/.+\.googleapis\.com\/youtubei\/.*\/log_event
URL-REGEX,https?\:\/\/.+\.googleapis\.com\/youtubei\/.*\/issuetoken
URL-REGEX,https?\:\/\/.*\.google\.com\/ads\/on-device\/conversions\?.*
URL-REGEX,https?\:\/\/.*\.google\.com\/js\/th\/lTforlp.*\.js
# URL-REGEX,https?\:\/\/.*\.google\.com\/js\/th\/.*\.js
URL-REGEX,https?\:\/\/premiumyva\.appspot\.com\/vmclickstoadvertisersite
URL-REGEX,https?\:\/\/s0.2mdn\.net\/ads\/
URL-REGEX,https?\:\/\/stats\.tubemogul\.com\/stats\/
URL-REGEX,https?\:\/\/api\.catch\.gift\/api\/v\d\/pagead\/
URL-REGEX,^https?\://suggestqueries\.google\.com/complete/search\?client=youtube-ios-pb&xssi=t&q=[^&]*&hl=[a-z]{2}-[A-Z]{2}&hjson=t&oe=UTF-8&ds=yt&gs_pcr=t&cp=\d+&gl=[A-Z]{2}&video_id=[^&]*&ytvs=1&w=\d+&h=\d+$

[URL Rewrite]
#初次修改（逗号的位置修正——原脚本正则似乎有误）
(^https?:\/\/(?!r\d-)[\w-]+\.googlevideo\.com\/(?!dclk_video_ads).+?)&ctier=L(&.+?),ctier(,.+?)((&probe=1)|$) $1$2$3 header
#增加适用范围（适用于连接到电视时）
(^https?:\/\/(?!r\d-)[\w-]+\.googlevideo\.com\/(?!dclk_video_ads).+?)\/ctier\/L(\/.+?),ctier(,.+?)((\/probe\/1)|$) $1$2$3 header
#进一步增加适用范围（适用于连接到电视时,逗号被url编码）
(^https?:\/\/(?!r\d-)[\w-]+\.googlevideo\.com\/(?!dclk_video_ads).+?)\/ctier\/L(\/.+?)%2Cctier(%2C.+?)((\/probe\/1)|$) $1$2$3 header
^https?:\/\/[\w-]+\.googlevideo\.com\/(?!(dclk_video_ads|videoplayback\?)).+&oad - reject
^https?:\/\/youtubei\.googleapis\.com\/youtubei\/v\d\/player\/ad_break - reject
^https?:\/\/(www|s)\.youtube\.com\/api\/stats\/ads - reject
^https?:\/\/(www|s)\.youtube\.com\/(pagead|ptracking) - reject
^https?:\/\/s\.youtube\.com\/api\/stats\/qoe\?adcontext - reject

[Script]
http-request ^https?:\/\/.+\?,script-path=https://github.com/iamfugui/youtube-adb/raw/main/index.user.js

[MITM]
hostname = %APPEND% -redirector*.googlevideo.com, *.googlevideo.com, *.youtube.com, youtubei.googleapis.com:443, s.youtube.com:443, www.youtube-nocookie.com:443


