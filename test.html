<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V5.46 æŒ‡ç´‹é˜²è­·æª¢æ¸¬å„€</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f4f4f7; color: #333; padding: 20px; max-width: 600px; margin: 0 auto; }
        .card { background: white; border-radius: 16px; padding: 24px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 20px; }
        h1 { font-size: 22px; margin-bottom: 8px; color: #1d1d1f; }
        h2 { font-size: 16px; margin-bottom: 12px; color: #86868b; text-transform: uppercase; letter-spacing: 0.5px; }
        .status { font-size: 18px; font-weight: 600; padding: 8px 12px; border-radius: 8px; display: inline-block; margin-bottom: 10px; }
        .safe { background-color: #e5f9e7; color: #2e7d32; }
        .danger { background-color: #ffebee; color: #c62828; }
        .neutral { background-color: #e3f2fd; color: #1565c0; }
        .metric { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #eee; }
        .metric:last-child { border-bottom: none; }
        .label { color: #666; }
        .value { font-family: monospace; font-weight: 600; }
        button { background-color: #007aff; color: white; border: none; padding: 12px 24px; border-radius: 12px; font-size: 16px; width: 100%; font-weight: 600; cursor: pointer; }
        button:active { background-color: #005ecb; }
        .info { font-size: 13px; color: #888; margin-top: 20px; text-align: center; line-height: 1.5; }
    </style>
</head>
<body>

    <h1>ğŸ›¡ï¸ V5.46 é˜²è­·ç‹€æ…‹æª¢æ¸¬</h1>
    <p>å³æ™‚åˆ†æç€è¦½å™¨ç’°å¢ƒæ˜¯å¦å—åˆ° Universal-Fingerprint-Poisoning ä¿è­·ã€‚</p>

    <div class="card">
        <h2>æ ¸å¿ƒç‹€æ…‹ (Core Status)</h2>
        <div id="protectionStatus" class="status neutral">æª¢æ¸¬ä¸­...</div>
        <div class="metric">
            <span class="label">è…³æœ¬æ³¨å…¥ (Injection)</span>
            <span class="value" id="injectVal">-</span>
        </div>
        <div class="metric">
            <span class="label">é‹ä½œæ¨¡å¼ (Persona)</span>
            <span class="value" id="personaVal">-</span>
        </div>
         <div class="metric">
            <span class="label">Canvas å™ªè² (Noise)</span>
            <span class="value" id="noiseVal">-</span>
        </div>
    </div>

    <div class="card">
        <h2>æŒ‡ç´‹ç‰¹å¾µ (Fingerprint Specs)</h2>
        <div class="metric">
            <span class="label">Platform</span>
            <span class="value" id="platVal">-</span>
        </div>
        <div class="metric">
            <span class="label">Concurrency</span>
            <span class="value" id="cpuVal">-</span>
        </div>
        <div class="metric">
            <span class="label">Device Memory</span>
            <span class="value" id="memVal">-</span>
        </div>
        <div class="metric">
            <span class="label">User Agent</span>
            <div class="value" style="font-size: 10px; text-align: right; max-width: 60%;" id="uaVal">-</div>
        </div>
    </div>

    <div class="card">
        <h2>æ™‚é–“çª— (Rhythm)</h2>
        <div class="metric">
            <span class="label">ç›®å‰ç¨®å­ (Session Seed)</span>
            <span class="value" id="seedVal">éš±è— (Hidden)</span>
        </div>
        <div class="metric">
            <span class="label">ç©©å®šæ€§èªªæ˜</span>
            <div class="value" style="font-size: 11px; max-width: 60%; text-align: right;">æŒ‡ç´‹æ¯ 20-50 åˆ†é˜è®Šæ›´ä¸€æ¬¡ï¼Œé‡æ–°æ•´ç†ä¸æœƒæ”¹è®Šé›œæ¹Šå€¼ã€‚</div>
        </div>
    </div>

    <button onclick="runCheck()">é‡æ–°æª¢æ¸¬ (Re-Scan)</button>

    <p class="info">è«‹åœ¨ Surge é–‹å•Ÿä¸¦å•Ÿç”¨ V5.46 è…³æœ¬çš„ç’°å¢ƒä¸‹åŸ·è¡Œæ­¤é é¢ã€‚<br>è‹¥é¡¯ç¤ºã€Œæœªæª¢æ¸¬åˆ°é˜²è­·ã€ï¼Œè«‹æª¢æŸ¥ HTTPS è§£å¯†æ˜¯å¦å•Ÿç”¨ã€‚</p>

    <script>
        function detectNoise() {
            // V5.46 å™ªè²æª¢æ¸¬é‚è¼¯ï¼šç¹ªè£½ç´”è‰²ï¼Œæª¢æŸ¥æ˜¯å¦æœ‰åƒç´ åç§»
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 200; // ç¬¦åˆ V5.46 çš„è§¸ç™¼æ¢ä»¶ (16 < w < 400)
            canvas.height = 50; 
            
            // å¡«æ»¿ç´”é»‘è‰² (0,0,0)
            ctx.fillStyle = "rgb(0,0,0)";
            ctx.fillRect(0, 0, 200, 50);
            
            // è®€å–åƒç´ æ•¸æ“š (é€™æœƒè§¸ç™¼ V5.46 çš„ Proxy)
            // V5.46 æœƒéš¨æ©Ÿå°éƒ¨åˆ†åƒç´ é€²è¡Œ +1/-1 çš„èª¿æ•´
            try {
                const imageData = ctx.getImageData(0, 0, 200, 50);
                const data = imageData.data;
                let noiseDetected = false;
                let noiseCount = 0;

                for (let i = 0; i < data.length; i += 4) {
                    // æª¢æŸ¥ RGB æ˜¯å¦ä¸ç­‰æ–¼ 0 (å¦‚æœä¸ç­‰æ–¼0ï¼Œè¡¨ç¤ºè¢«æ³¨å…¥äº†å™ªè²)
                    if (data[i] !== 0 || data[i+1] !== 0 || data[i+2] !== 0) {
                        noiseDetected = true;
                        noiseCount++;
                    }
                }
                return { detected: noiseDetected, count: noiseCount };
            } catch(e) {
                return { detected: false, error: e.message };
            }
        }

        function runCheck() {
            const noiseResult = detectNoise();
            const ua = navigator.userAgent;
            const platform = navigator.platform;
            
            // 1. æª¢æ¸¬è…³æœ¬æ˜¯å¦æ³¨å…¥ (æª¢æŸ¥æœ‰ç„¡å…¨åŸŸæ¨™è¨˜æˆ– Proxy è¡Œç‚º)
            // ç”±æ–¼ V5.46 éš±è—äº†å…¨åŸŸè®Šæ•¸ï¼Œæˆ‘å€‘ä¾è³´å™ªè²çµæœèˆ‡ Platform ç‰¹å¾µ
            
            const isSpoofedMac = platform === 'MacIntel' && !/iPhone|iPad/i.test(ua);
            const isNativeIOS = /iPhone|iPad/i.test(ua);
            
            // æ›´æ–° UI
            document.getElementById('platVal').textContent = platform;
            document.getElementById('cpuVal').textContent = navigator.hardwareConcurrency || 'N/A';
            document.getElementById('memVal').textContent = navigator.deviceMemory || 'N/A';
            document.getElementById('uaVal').textContent = ua.substring(0, 40) + '...';
            
            document.getElementById('noiseVal').textContent = noiseResult.detected ? 
                `DETECTED (Pix: ${noiseResult.count})` : "None";

            const statusEl = document.getElementById('protectionStatus');
            const injectEl = document.getElementById('injectVal');
            const personaEl = document.getElementById('personaVal');

            if (noiseResult.detected) {
                statusEl.textContent = "âœ… å— V5.46 ä¿è­·ä¸­";
                statusEl.className = "status safe";
                injectEl.textContent = "Active";
                
                if (isSpoofedMac) {
                    personaEl.textContent = "macOS Spoofing";
                } else if (isNativeIOS) {
                    personaEl.textContent = "iOS Native Enhanced";
                } else {
                    personaEl.textContent = "Unknown Persona";
                }
            } else {
                statusEl.textContent = "âš ï¸ æœªæª¢æ¸¬åˆ°é˜²è­·";
                statusEl.className = "status danger";
                injectEl.textContent = "Inactive";
                personaEl.textContent = "Original";
            }
        }

        // Auto run on load
        window.onload = runCheck;
    </script>
</body>
</html>